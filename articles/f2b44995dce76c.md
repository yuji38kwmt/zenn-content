---
title: "sphinx-last-updated-by-git: Gitã‹ã‚‰å–å¾—ã—ãŸæœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹"
emoji: "ğŸ¤–"
type: "tech"
topics: ["python", "sphinx"]
published: true
---

# æ¦‚è¦
[phinx-last-updated-by-git](https://github.com/mgeier/sphinx-last-updated-by-git)ã‚’ä½¿ã£ã¦ã€sphinxã§ç”Ÿæˆã—ãŸãƒšãƒ¼ã‚¸ã«ã€æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

phinx-last-updated-by-gitã¯ã€Gitã‹ã‚‰æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’å–å¾—ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

>This is a little Sphinx extension that does exactly that. It also checks for included files and other dependencies and uses their "last updated" time if it's more recent.
>If a page doesn't have a source file, its last_updated time is set to None.
>The default value for html_last_updated_fmt is changed from None to the empty string.


æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€èª­ã¿æ‰‹ã¯ã€Œã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å…¨ç„¶æ›´æ–°ã•ã‚Œã¦ã„ãªã„ã‹ã‚‰ã€æƒ…å ±ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€ãªã©ã‚’åˆ¤æ–­ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

# ç’°å¢ƒ
* Python 3.8.6
* sphinx 4.1.1
* pydata-sphinx-theme 0.6.3
* phinx-last-updated-by-git 0.3.0

# å‰ææ¡ä»¶
sphinxã®ãƒ†ãƒ¼ãƒã¯[pydata-sphinx-theme](https://github.com/pydata/pydata-sphinx-theme)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ç†ç”±ã‹ã‚‰ã€`pydata-sphinx-theme`ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚
* åˆ©ç”¨ã§ãã‚‹ãƒ†ãƒ¼ãƒã®ä¸­ã§ã€ä¸€ç•ªå¤è‡­ãªããªã„å°è±¡ã‚’å—ã‘ãŸ
* æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ`last-updated.html`ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚

sphinxã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```python:docs/conf.py
project = 'test'
copyright = '2021, yuji38kwmt'
author = 'yuji38kwmt'

extensions = [
]
templates_path = ['_templates']
exclude_patterns = ['_build', 'Thumbs.db', '.DS_Store']
html_theme = 'pydata_sphinx_theme'
html_static_path = ['_static']
```

# æ‰‹é †
å…¬å¼ã‚µã‚¤ãƒˆã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ‰‹é †ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ãŒã€å…·ä½“çš„ãªæ–¹æ³•ãŒåˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€è¨˜äº‹ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚

>Usage
>1. Install the Python package sphinx-last-updated-by-git
>2. Add 'sphinx_last_updated_by_git' to extensions in your conf.py
>3. Run Sphinx!

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
PyPIã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
$ pip install sphinx-last-updated-by-git
```

## conf.pyã®è¨­å®š
extensionsã«`sphinx_last_updated_by_git`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```python:docs/conf.py
extensions = ['sphinx_last_updated_by_git'
]
```

pydata-sphinx-themeã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ã¯ã€æœ€çµ‚æ›´æ–°æ—¥æ™‚ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã®ã§ã€ã“ã®çŠ¶æ…‹ã§sphinxã‚’å®Ÿè¡Œã—ã¦ã‚‚æœ€çµ‚æ›´æ–°æ—¥æ™‚ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

pydata_sphinx_themeã«ã¯æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã€æœ€åˆã‹ã‚‰ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’footerã«è¿½åŠ ã—ã¾ã™ã€‚
https://pydata-sphinx-theme.readthedocs.io/en/latest/user_guide/sections.html#a-list-of-built-in-templates-you-can-insert-into-sections

```python:docs/conf.py
html_theme_options = {
  "footer_items": ["copyright", "sphinx-version", "last-updated"],
}
```

ãªãŠã€[last-updated](https://github.com/pydata/pydata-sphinx-theme/blob/master/pydata_sphinx_theme/_templates/last-updated.html)ã®ä¸­èº«ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°`last_updated`ãŒæœ€çµ‚æ›´æ–°æ—¥æ™‚ã«å±•é–‹ã•ã‚Œã¾ã™ã€‚

```html:pydata_sphinx_theme/_templates/last-updated.html
<p class="last-updated">
{% trans last_updated=last_updated|e %}Last updated on {{ last_updated }}.{% endtrans %}<br>
</p>
```

## sphinx-buildã®å®Ÿè¡Œ
sphinx-buildã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ•ãƒƒã‚¿ãƒ¼ã«Gitã‹ã‚‰å–å¾—ã—ãŸæœ€çµ‚æ›´æ–°æ—¥æ™‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/c69534f581971f1da94722cc.png)

```
Last updated on Jul 23, 2021.
```

ReadTheDocsã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ã€Gitã‹ã‚‰å–å¾—ã—ãŸæœ€çµ‚æ›´æ–°æ—¥æ™‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

# è£œè¶³
## æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å¤‰æ›´
æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€[html_last_updated_fmt](https://www.sphinx-doc.org/ja/master/usage/configuration.html#confval-html_last_updated_fmt)ã«æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’è¨­å®šã—ã¾ã™ã€‚

```python:docs/conf.py
html_last_updated_fmt = '%Y-%m-%d %H:%M:%S'
```

ãƒ•ãƒƒã‚¿ãƒ¼ã«ã¯ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
```
Last updated on 2021-07-23 12:31:29.
```

## phinx-last-updated-by-gitã‚’ä½¿ã‚ãªã„å ´åˆ
phinx-last-updated-by-gitã‚’ä½¿ã‚ãªãã¦ã‚‚æœ€çµ‚æ›´æ–°æ—¥æ™‚ã¯è¡¨ç¤ºã§ãã¾ã™ãŒã€ãã®å ´åˆæœ€çµ‚æ›´æ–°æ—¥ã¯ã€Œãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸæ—¥æ™‚ã€ã«ãªã‚Šã¾ã™ã€‚
https://www.sphinx-doc.org/ja/master/templating.html#last_updated
